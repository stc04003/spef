<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fits Semiparametric Regression Models for Panel Count Survival Data — panelReg • spef</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Fits Semiparametric Regression Models for Panel Count Survival Data — panelReg" />

<meta property="og:description" content="Fits an proportional means model:
$$\Lambda (t; X_i) = E[N_i(t)|X_i] = \Lambda(t)e^{X_i ' \beta},$$
where \(\beta\) is a \(p \times 1\) vector of covariate
coefficient and \(\Lambda(\cdot)\) is a completely unspecified
baseline mean function.
Estimating procedures include: Wang-Yan's augmented estimating
equations (&quot;AEE&quot;, &quot;AEEX&quot;),
Huang-Wang-Zhang's method (&quot;HWZ&quot;),
Zhang's maximum pseudo-likelihood (&quot;MPL&quot;),
Maximum pseudolikelihood with I-Splines (&quot;MPLs&quot;),
Maximum likelihood with I-Splines (&quot;MLs&quot;),
Sun-Wei's method (&quot;EE.SWa&quot;, &quot;EE.SWb&quot;, &quot;EE.SWc&quot;),
and Hu-Sun-Wei's method (&quot;EE.HSWc&quot;, &quot;EE.HSWm&quot;).
The function can also fits an accelerated mean model (&quot;AMM&quot;):
$$\Lambda (t; X_i) = E[N_i(t)|X_i] = \Lambda(te^{X_i ' \beta})e^{X_i ' \beta}.$$" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spef</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.0.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/stc04003/spef">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fits Semiparametric Regression Models for Panel Count Survival Data</h1>
    <small class="dont-index">Source: <a href='http://github.com/stc04003/spef/blob/master/R/panelReg.R'><code>R/panelReg.R</code></a></small>
    <div class="hidden name"><code>panelReg.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Fits an proportional means model:
$$\Lambda (t; X_i) = E[N_i(t)|X_i] = \Lambda(t)e^{X_i ' \beta},$$
where \(\beta\) is a \(p \times 1\) vector of covariate
coefficient and \(\Lambda(\cdot)\) is a completely unspecified
baseline mean function.</p>
<p>Estimating procedures include: Wang-Yan's augmented estimating
equations (<code>"AEE"</code>, <code>"AEEX"</code>),
Huang-Wang-Zhang's method (<code>"HWZ"</code>),
Zhang's maximum pseudo-likelihood (<code>"MPL"</code>),
Maximum pseudolikelihood with I-Splines (<code>"MPLs"</code>),
Maximum likelihood with I-Splines (<code>"MLs"</code>),
Sun-Wei's method (<code>"EE.SWa"</code>, <code>"EE.SWb"</code>, <code>"EE.SWc"</code>),
and Hu-Sun-Wei's method (<code>"EE.HSWc"</code>, <code>"EE.HSWm"</code>).</p>
<p>The function can also fits an accelerated mean model (<code>"AMM"</code>):
$$\Lambda (t; X_i) = E[N_i(t)|X_i] = \Lambda(te^{X_i ' \beta})e^{X_i ' \beta}.$$</p>
    
    </div>

    <pre class="usage"><span class='fu'>panelReg</span>(<span class='no'>formula</span>, <span class='no'>data</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"AEE"</span>, <span class='st'>"AEEX"</span>, <span class='st'>"HWZ"</span>, <span class='st'>"MPL"</span>, <span class='st'>"MPLs"</span>, <span class='st'>"MLs"</span>,
  <span class='st'>"AMM"</span>, <span class='st'>"EE.SWa"</span>, <span class='st'>"EE.SWb"</span>, <span class='st'>"EE.SWc"</span>, <span class='st'>"EE.HSWc"</span>, <span class='st'>"EE.HSWm"</span>), <span class='kw'>se</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"NULL"</span>,
  <span class='st'>"smBootstrap"</span>, <span class='st'>"Bootstrap"</span>, <span class='st'>"Impute"</span>, <span class='st'>"Sandwich"</span>), <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'>list</span>())</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>A formula object, with the response on the left of a
"~" operator, and the terms on the right. The response must be a
panel count survival object as returned by function <code>PanelSurv</code>.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A data.frame in which to interpret the variables named in
the <code>formula</code>. Three variables including subjects' id,
observation times, and number of new events since last
observation time are required to feed into function
<code>PanelSurv</code> as response. At least one covariate variable is required.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Fitting method. See &#8216;Details&#8217;.</p></td>
    </tr>
    <tr>
      <th>se</th>
      <td><p>Standard error estimation method. See &#8216;Details&#8217;.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>A list of control parameters. See &#8216;Details&#8217;.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of S3 class <code>"panelReg"</code> representing the fit.
See <code>panelReg.object</code> for details.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Some assumptions details about the observation times and censoring
time need clarification. Three possible scenarios of observation
times are considered: 1) independent observation times -- the
observation times are independent of the underlying recurrent event
process; 2) conditional independent observation times -- the
observation times are independent of the event process given
observed covariates; 3) informative observation times -- after
conditioning on observed covariates, the observation times and the
event process are still dependent through an unobserved
multiplicative frailty. Similarly, the three scenarios apply to the
censoring time.</p>
<p><code>"AEE"</code> and <code>"AEEX"</code> are the augmented estimating
 equation methods under conditional independent censoring and
 informative censoring respectively. Both allow informative observation times.</p>
<p><code>"HWZ"</code> is Huang-Wang-Zhang's method. It allows both
  information observation times and informative censoring time. It does
  not need to specify the dependence structure or model the frailty.</p>
<p><code>"MPL"</code> and <code>"MPLs"</code> are maximum pseudolikelihood
  methods, with nonparametric and monotone spline estimates of the baseline
  mean function respectively. They assume conditional independent
  observation times and censoring time. The underlying event process
  is assumed to be Poisson, and the within subjects dependence is ignored.</p>
<p><code>"MLs"</code> is maximum likelihood method with monotone splines
  estimates of the baseline mean function. It assumes conditional
  independent observation times and censoring time, and a Poisson
  underlying event process.</p>
<p><code>"EE.SWa"</code>, <code>"EE.SWb"</code> and <code>"EE.SWc"</code> are estimating
  equation approaches based on Sun-Wei's methods.
  The first assumes independent observation times and censoring
  time. The second assumes conditional independent observation times but
  independent censoring time. The third assumes conditional independent
  observation times and censoring time. All three variations work on
  centered covariates and avoid estimating the baseline mean.</p>
<p><code>"EE.HSWc"</code> and <code>"EE.HSWm"</code> are estimating
  equation approaches based on Hu-Sun-Wei's methods.
  The first assumes independent observation times and censoring
  time. The second assumes conditional independent observation times but
  independent censoring time. Both variations work on centered covariates
  and avoid estimating the baseline mean.</p>
<p><code>"AMM"</code> is the accelerated mean model.
  The observation time process is allowed to be correlated with
  the underlying recurrent event process through a frailty variable,
  which does not need to be specified. The model also allows marginal
  interpretations for the regression parameters and connects naturally
  with AFT model. See Chiou et al. (2017) for more details.</p>
<p>For standard errors estimation method:</p>
<p><code>"NULL"</code> means do not calculate standard errors;
  <code>"smBootstrap"</code> is the smoothed bootstrap estimation method
  that works with <code>"AMM"</code>.
  <code>"Bootstrap"</code> works with all fitting methods; <code>"Impute"</code> is
  the multiple imputation method that works with <code>"AEE"</code> and
  <code>"AEEX"</code>; <code>"Sandwich"</code> is the robust sandwich estimation
  method that works with <code>"AEE"</code> and <code>"AEEX"</code>.</p>
<p>The <code>control</code> argument is a list that can supply any of the
  following components:</p><dl class='dl-horizontal'>
    <dt><code>betaInit</code>:</dt><dd><p>Object of class <code>"numeric"</code>,
      initial value for covariate coefficient, default <code>0</code>.</p></dd>
    <dt><code>interval</code>:</dt><dd><p>Object of class <code>"numeric"</code>,
      initial search interval for solving <code>beta</code>, default
      <code>(-5, 5)</code>.</p></dd>
    <dt><code>maxIter</code>:</dt><dd><p>Object of class <code>"numeric"</code>, maximum
      iteration allowed, default <code>500</code> for <code>"AEEX"</code> and
      <code>"HWZ"</code>, <code>150</code> for others.</p></dd>
    <dt><code>absTol</code>:</dt><dd><p>Object of class <code>"numeric"</code>, absolute
      tolerance, default <code>1e-6</code>.</p></dd>
    <dt><code>relTol</code>:</dt><dd><p>Object of class <code>"numeric"</code>, relative
      tolerance, default <code>1e-6</code>.</p></dd>
    <dt><code>a</code>:</dt><dd><p>Object of class <code>"numeric"</code>, a tune parameter,
      default <code>0.1</code>. In the case of gamma frailty, <code>"a"</code>
      corresponds to the value of both shape and rate parameters.</p></dd>
    <dt><code>R</code>:</dt><dd><p>Object of class <code>"numeric"</code>, number of
      bootstrap or imputation, default 30.</p></dd>
  </dl>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Chiou, S., Xu, G., Yan, J., and Huang, C.-Y. (2017).
Semiparametric estimation of the accelerated mean model with panel count data under
informative examination times. <em>Biometrics</em>, to appear.
&lt;doi: 10.1111/biom.12840&gt;.</p>
<p>Huang, C.-Y., Wang, M., and Zhang, Y. (2006).
Analysing panel count data with informative observation times.
<em>Biometrika</em>, <b>93</b>(4), 763--776.</p>
<p>Hu, X. J., Sun, J. and Wei, L. J. (2003).
Regression parameter estimation from panel counts.
<em>Scandinavian Journal of Statistics</em>, <b>30</b>, 25--43.</p>
<p>Lu, M., Zhang, Y., and Huang, J. (2007).
Estimation of the mean function with panel count data using monotone polynomial splines.
<em>Biometrika</em>, <b>94</b>(3), 705--718.</p>
<p>Sun, J. and Wei, L. J. (2000). Regression analysis of panel count
data with covariates-dependent observation and censoring times.
<em>Journal of the Royal Statistical Society, Series B: Statistical Methodology</em>,
<b>62</b>(2), 293--302.</p>
<p>Wang, X. and Yan, J. (2011). Fitting semiparametric regressions for panel
count survival data with an R package spef.
<em>Computer Methods and Programs in Biomedicine</em>, <b>104</b>(2), 278--285.</p>
<p>Wang, X. and Yan, J. (2013). Augmented estimating equations for
semiparametric panel count regression with informative observation
times and censoring time. <em>Statistica Sinica</em>, 359--381.</p>
<p>Zhang, Y. (2002). A Semiparametric pseudolikelihood estimation method
for panel count data. <em>Biometrika</em>, <b>89</b>(1), 39--48.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='panelReg.object.html'>panelReg.object</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='fu'>data</span>(<span class='no'>blaTum</span>)
<span class='co'>## Fit the bladder tumor data set</span>
<span class='no'>formula</span> <span class='kw'>&lt;-</span> <span class='fu'>PanelSurv</span>(<span class='no'>id</span>, <span class='no'>time</span>, <span class='no'>count</span>) ~ <span class='no'>num</span> + <span class='no'>size</span> + <span class='no'>treatment</span>

<span class='fu'>panelReg</span>(<span class='no'>formula</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>blaTum</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"AEE"</span>, <span class='kw'>se</span> <span class='kw'>=</span> <span class='st'>"Sandwich"</span>)
<span class='fu'>panelReg</span>(<span class='no'>formula</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>blaTum</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"AEEX"</span>, <span class='kw'>se</span> <span class='kw'>=</span> <span class='st'>"Impute"</span>,
         <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>a</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>R</span> <span class='kw'>=</span> <span class='fl'>30</span>))
<span class='fu'>panelReg</span>(<span class='no'>formula</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>blaTum</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"HWZ"</span>, <span class='kw'>se</span> <span class='kw'>=</span> <span class='st'>"Bootstrap"</span>,
         <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>R</span> <span class='kw'>=</span> <span class='fl'>30</span>))
<span class='fu'>panelReg</span>(<span class='no'>formula</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>blaTum</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"MLs"</span>, <span class='kw'>se</span> <span class='kw'>=</span> <span class='st'>"NULL"</span>)
<span class='fu'>panelReg</span>(<span class='no'>formula</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>blaTum</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"EE.SWa"</span>, <span class='kw'>se</span> <span class='kw'>=</span> <span class='st'>"Bootstrap"</span>,
         <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>R</span> <span class='kw'>=</span> <span class='fl'>30</span>))
<span class='fu'>panelReg</span>(<span class='no'>formula</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>blaTum</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"EE.HSWc"</span>, <span class='kw'>se</span> <span class='kw'>=</span> <span class='st'>"Bootstrap"</span>,
         <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>R</span> <span class='kw'>=</span> <span class='fl'>30</span>))
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Sy Han (Steven) Chiou, Xiaojing Wang, Jun Yan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

